fun toUtf8Reader(file: MultipartFile): InputStreamReader {
    val fileBytes = file.bytes
    val detectedEncoding = detectEncoding(fileBytes)
    println("Detected encoding: $detectedEncoding") // debug log

    // Cas où detection échoue ou ASCII pur
    val encodingToUse = detectedEncoding ?: "ISO-8859-1"
    println("Using encoding: $encodingToUse") // debug log

    return InputStreamReader(ByteArrayInputStream(fileBytes), Charset.forName(encodingToUse))
}